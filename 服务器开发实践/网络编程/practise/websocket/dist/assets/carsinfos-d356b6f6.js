import{d as G,r as h,o as H,a as v,E as u,b as s,c as J,w as a,e as K,f as e,u as n,g as i,t as f,h as C,_ as Q}from"./index-7fce9f59.js";const U=G({__name:"carsinfos",props:{message:Object,carCompare:Array},emits:["addComCar"],setup(F,{emit:S}){var d=F.message,x=h(),A=[{text:"1-3万",value:1},{text:"3-6万",value:2},{text:"6-9万",value:3},{text:"9-12万",value:4},{text:"12-15万",value:5},{text:"15-18万",value:6},{text:"18-21万",value:7},{text:"21-24万",value:8}],w=h(),r=h([{id:1,brand_name:"奥迪",model_name:"奥迪A4L",displacement:2,price:25e4,release_date:"2019-12-01",mileage:1e4,registration_date:"2020-01-01",type_of_clutch:"自动"}]),_=h(0);H(()=>{I()});const E=t=>{S("addComCar",t)},I=async()=>{try{let t=await v.post("http://localhost:8080/getAllCarInfo");r.value=t.data,M(t.data)}catch(t){u.error(t)}},M=t=>{let l=[],o=[],m=[],b=[];for(let c=0;c<t.length;c++){let g=t[c];l.push(g.brand_name),o.push(g.release_date.substring(0,4))}for(const c of[...new Set(l)])m.push({text:c,value:c});for(const c of[...new Set(o)])b.push({text:c+" 年",value:c});x.value=m,w.value=b},N=(t,l)=>{let o=(t-1)*3e4,m=t*3e4;return l.price>=o&&l.price<=m},$=(t,l)=>l.release_date.includes(t),z=(t,l)=>l.brand_name===t,T=t=>{for(let l=0;l<r.value.length;l++)if(t.id==r.value[l].id){_.value=l;break}},V=async t=>{if(d.id===-1){u.error("请先登陆");return}try{let l=await v.post("http://localhost:8080/addCollect",{user_id:d.id,car_id:t.id});if(l.data==-1){u.info("已经收藏过了哦!");return}else l.data==1?u.success("收藏成功!"):u.error("收藏失败!")}catch(l){u.error(l)}},j=async t=>{if(d.id===-1){u.error("请先登陆");return}try{let l=await v.post("http://localhost:8080/addStorehouse",{user_id:d.id,car_id:t.id});if(l.data==-1){u.info("已经购买过了哦!");return}else if(l.data==1){if(parseFloat(d.money)-t.price<0){C.info("余额不足请充值!");return}(await v.post("http://localhost:8080/updateMoney",{username:d.username,id:d.id,money:parseFloat(d.money)-t.price})).data==0?C.error("购买失败!"):(d.money=parseFloat(d.money)-t.price,C.success("购买成功!"))}else u.error("购买失败!")}catch(l){u.error(l)}};return(t,l)=>{const o=s("el-table-column"),m=s("el-button"),b=s("el-dropdown-item"),c=s("el-dropdown-menu"),g=s("el-dropdown"),D=s("el-table"),L=s("el-scrollbar"),O=s("el-main"),p=s("el-descriptions-item"),k=s("el-tag"),P=s("el-descriptions"),R=s("el-footer"),q=s("el-container");return K(),J(q,{class:"layout-container-demo",style:{height:"100%"}},{default:a(()=>[e(O,null,{default:a(()=>[e(L,null,{default:a(()=>[e(D,{data:n(r),"table-layout":"auto",onRowClick:T,filterable:"true"},{default:a(()=>[e(o,{prop:"id",label:"id",width:"140",align:"center",sortable:""}),e(o,{prop:"brand_name",label:"品牌",width:"120",align:"center",filters:n(x),"filter-method":z},null,8,["filters"]),e(o,{sortable:"",prop:"model_name",label:"车型",align:"center"}),e(o,{prop:"mileage",label:"里程数",sortable:"",align:"center"}),e(o,{prop:"price",label:"价格",sortable:"",align:"center",filters:n(A),"filter-method":N},null,8,["filters"]),e(o,{prop:"release_date",label:"发布时间",sortable:"",align:"center",filters:n(w),"filter-method":$},null,8,["filters"]),e(o,{align:"left"},{default:a(({row:y})=>[e(g,null,{dropdown:a(()=>[e(c,null,{default:a(()=>[e(b,{onClick:B=>V(y)},{default:a(()=>[i("收藏")]),_:2},1032,["onClick"]),e(b,{onClick:B=>E(y)},{default:a(()=>[i("加入对比")]),_:2},1032,["onClick"]),e(b,{onClick:B=>j(y)},{default:a(()=>[i("购买")]),_:2},1032,["onClick"])]),_:2},1024)]),default:a(()=>[e(m,{type:"success",plain:""},{default:a(()=>[i("操作")]),_:1})]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),e(R,null,{default:a(()=>[e(P,{title:"详细信息",column:3,border:""},{default:a(()=>[e(p,{label:"id","label-align":"center",align:"center","label-class-name":"my-label","class-name":"my-content",width:"150px"},{default:a(()=>[i(f(n(r)[n(_)].id),1)]),_:1}),e(p,{label:"品牌","label-align":"center",align:"center"},{default:a(()=>[e(k,{size:"large"},{default:a(()=>[i(f(n(r)[n(_)].brand_name),1)]),_:1})]),_:1}),e(p,{label:"车辆型号","label-align":"center",align:"center"},{default:a(()=>[e(k,{size:"large"},{default:a(()=>[i(f(n(r)[n(_)].model_name),1)]),_:1})]),_:1}),e(p,{label:"里程数",span:"1","label-align":"center",align:"center"},{default:a(()=>[i(f(n(r)[n(_)].mileage),1)]),_:1}),e(p,{label:"价格","label-align":"center",align:"center"},{default:a(()=>[i(f(n(r)[n(_)].price),1)]),_:1}),e(p,{label:"排量","label-align":"center",align:"center"},{default:a(()=>[i(f(n(r)[n(_)].displacement),1)]),_:1}),e(p,{label:"离合器类型","label-align":"center",align:"center",span:"3"},{default:a(()=>[i(f(n(r)[n(_)].type_of_clutch),1)]),_:1}),e(p,{label:"上牌时间",span:"3","label-align":"center",align:"center"},{default:a(()=>[i(f(n(r)[n(_)].registration_date),1)]),_:1}),e(p,{label:"登记时间",span:"3","label-align":"center",align:"center"},{default:a(()=>[i(f(n(r)[n(_)].release_date),1)]),_:1})]),_:1})]),_:1})]),_:1})}}});const Y=Q(U,[["__scopeId","data-v-3c9f7ca9"]]);export{Y as default};
